<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="item-product.html">
<link rel="import" href="product-data.html">
<dom-module id="category-view">
    <template>
        <style>
            :host{
                z-index: -30;
            }

            h1{
                color: black;
            }

        </style>
        
        <app-route
            id="appRoute"
            route="[[route]]"
            pattern="/:id/:category"
            data="{{routeData}}">
        </app-route>
        
        <firebase-query
            id="query"
            path="/categories/{{routeData.id}}/products"
            order-by-child="name"
            equal-to="{{inputSearch}}"
            data="{{productsList}}">
        </firebase-query>
        
<!--
        <product-data
            id="productData"
            data="{{products}}">
        </product-data> 
-->
                        
         <div class="row">
            <paper-input class="col-12 col-sm-12 col-md-6 col-lg-2 col-xl-4" id="inputSearch" label="Buscar" type="search" on-input="_search" value="{{inputSearch}}">
                <iron-icon icon="search" slot="suffix"></iron-icon>
            </paper-input>            
        </div>                        
        <iron-list items="[[productsList]]" as="product">
            <template>                
                <a href="/detail/{{routeData.id}}/{{routeData.category}}/[[product.$key]]/[[product.name]]">
                    <item-product item="{{product}}"></item-product>
                </a>
            </template>                  
        </iron-list>                        
    </template>

    <script>
        class CategoryView extends Polymer.Element{
            static get is(){ return 'category-view'}
                                
            static get properties(){
                return{
                    productsList: Array,
                    
                    category: Object,                    

                    route:{
                        type: Object,
//                        observer: '_routeChanged'
                    },
                    
                    key: String,                   
                };
            }            
            
//            _routeChanged(){                
//                let categoryKey = this.$.appRoute.data.id;
//                this.$.productData._getProductsByCategory(categoryKey);
//            }
            
            _search(e){
   
            }    
        }
        window.customElements.define(CategoryView.is, CategoryView);
    </script>
    </dom-module>