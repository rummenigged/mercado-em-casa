<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="item-product.html">
<link rel="import" href="product-data.html">
<dom-module id="category-view">
    <template>
        <style>
            :host{
                z-index: -30;
            }

            h1{
                color: black;
            }

        </style>
        
        <app-route
            id="appRoute"
            route="[[route]]"
            pattern="/:id/:category"
            data="{{routeData}}">
        </app-route>
        
<!--
        <firebase-query
            id="query"
            path="/categories/{{routeData.id}}/products"
            data="{{products}}">
        </firebase-query>
-->
        
        <product-data
            id="productData"
            data="{{products}}">
        </product-data> 
                        
        <iron-list items="[[products]]" as="product">
            <template>                
                <a href="/detail/{{routeData.id}}/{{routeData.category}}/[[product.$key]]/[[product.name]]">
                    <item-product item="{{product}}"></item-product>
                </a>                                                                  
            </template>                  
        </iron-list>                        
    </template>

    <script>
        class CategoryView extends Polymer.Element{
            static get is(){ return 'category-view'}
                                
            static get properties(){
                return{
                    productsList: Object,
                    
                    category: Object,                    

                    route:{
                        type: Object,
                        observer: '_routeChanged'
                    },
                    
                    key: String,                   
                };
            }            
            
            _routeChanged(){                
                let categoryKey = this.$.appRoute.data.id;
                this.$.productData._getProductsByCategory(categoryKey);
            }
        }
        window.customElements.define(CategoryView.is, CategoryView);
    </script>
    </dom-module>