<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<dom-module id="product-detail">
    <template>
        <style>
            
            #content{
                color: black;
            }
            .price{
                color: green;
            }
        </style>

        <app-route
            route=[[route]]
            pattern="/:category/:item"
            data="{{routeData}}">
        </app-route>

        <iron-ajax
            auto
            url="../../data/{{routeData.category}}.json"
            handler-as="json"
            on-response="_handlerProducts">
        </iron-ajax>
        
        <div id="content">
            <h1>{{item.name}}</h1>
            <h3 class="price">R${{item.price}}</h3>            
            <p>{{item.description}}</p>
            <iron-image style="width:300px; height:300px;" sizing="contain"
                    src="[[item.image]]" alt="[[item.name]]"></iron-image>
            <paper-button class="red" raised on-tap="_addCart">Add Cart</paper-button>
        </div>
    </template>
    <script>
        class ProductDetail extends Polymer.Element{
            static get is(){ return 'product-detail'}

            static get properties(){
                return{
                    item: {
                        type:Object,
                        readOnly: true                        
                    },
                    itemPathName: String,
                    route: Object                
                }
            }

            static get observers(){
                return [
                    '_routePageChanged(routeData.item)'
                ] ;
            }

            _routePageChanged(item){
                this.itemPathName = item;                
            }

            _handlerProducts(event){
                let productsList = event.detail.response.productslist;                
                for(let i = 0 ; i < productsList.length ; i++){                    
                    if(this.itemPathName === productsList[i].name){                        
                        this._setItem(productsList[i]);
                    }
                }
            }
            
            _addCart(){
                console.log("Click Add Cart Button");
            }
        }
        window.customElements.define(ProductDetail.is, ProductDetail);
    </script>
</dom-module>